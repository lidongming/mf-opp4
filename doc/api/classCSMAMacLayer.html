<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Mobility Framework: CSMAMacLayer Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>CSMAMacLayer Class Reference<br>
<small>
[<a class="el" href="group__macLayer.html">macLayer - MAC layer modules</a>]</small>
</h1><!-- doxytag: class="CSMAMacLayer" --><!-- doxytag: inherits="BasicMacLayer" -->MAC module which provides non-persistent CSMA.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="CSMAMacLayer_8h-source.html">CSMAMacLayer.h</a>&gt;</code>
<p>
Inherits <a class="el" href="classBasicMacLayer.html">BasicMacLayer</a>.
<p>
Inheritance diagram for CSMAMacLayer:<p><center><img src="classCSMAMacLayer__inherit__graph.png" border="0" usemap="#CSMAMacLayer__inherit__map" alt="Inheritance graph"></center>
<map name="CSMAMacLayer__inherit__map">
<area href="classBasicMacLayer.html" shape="rect" coords="10,233,122,257" alt="">
<area href="classBasicLayer.html" shape="rect" coords="22,158,110,182" alt="">
<area href="classBasicModule.html" shape="rect" coords="17,83,115,107" alt="">
<area href="classImNotifiable.html" shape="rect" coords="21,9,111,33" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for CSMAMacLayer:<p><center><img src="classCSMAMacLayer__coll__graph.png" border="0" usemap="#CSMAMacLayer__coll__map" alt="Collaboration graph"></center>
<map name="CSMAMacLayer__coll__map">
<area href="classBasicMacLayer.html" shape="rect" coords="85,278,197,302" alt="">
<area href="classBasicLayer.html" shape="rect" coords="23,177,111,201" alt="">
<area href="classBasicModule.html" shape="rect" coords="59,99,158,123" alt="">
<area href="classSingleChannelRadio.html" shape="rect" coords="246,278,387,302" alt="">
<area href="classImNotifiable.html" shape="rect" coords="7,9,98,33" alt="">
<area href="classBlackboard.html" shape="rect" coords="122,9,210,33" alt="">
<area href="classDroppedPacket.html" shape="rect" coords="481,227,593,251" alt="">
<area href="classBBItem.html" shape="rect" coords="375,99,442,123" alt="">
<area href="classBitrate.html" shape="rect" coords="319,177,378,201" alt="">
<area href="classRadioState.html" shape="rect" coords="402,177,490,201" alt="">
<area href="classActiveChannel.html" shape="rect" coords="186,177,295,201" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classCSMAMacLayer-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0"></a><!-- doxytag: member="CSMAMacLayer::Module_Class_Members" ref="a0" args="(CSMAMacLayer, BasicMacLayer, 0)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>Module_Class_Members</b> (<a class="el" href="classCSMAMacLayer.html">CSMAMacLayer</a>, <a class="el" href="classBasicMacLayer.html">BasicMacLayer</a>, 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a1"></a><!-- doxytag: member="CSMAMacLayer::initialize" ref="a1" args="(int)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a1">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a2"></a><!-- doxytag: member="CSMAMacLayer::finish" ref="a2" args="()" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a2">finish</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete all dynamically allocated objects of the module. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a3">handleLowerMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower layer.  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a4">handleUpperMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from upper layer.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a5">handleSelfMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages such as timers.  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a6"></a><!-- doxytag: member="CSMAMacLayer::handleLowerControl" ref="a6" args="(cMessage *msg)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a6">handleLowerControl</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle control messages from lower layer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#a7">receiveBBItem</a> (int category, const <a class="el" href="classBBItem.html">BBItem</a> *details, int scopeModuleId)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by the <a class="el" href="classBlackboard.html">Blackboard</a> whenever a change occurs we're interested in.  <a href="#a7"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="x0"></a><!-- doxytag: member="CSMAMacLayer::MacQueue" ref="x0" args="" -->
typedef std::list&lt; MacPkt * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>MacQueue</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#x4">States</a> { <b>RX</b>, 
<b>CCA</b>, 
<b>TX</b>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">MAC states.  <a href="classCSMAMacLayer.html#x4">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#b0">scheduleBackoff</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">schedule a backoff  <a href="#b0"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p0"></a><!-- doxytag: member="CSMAMacLayer::macState" ref="p0" args="" -->
<a class="el" href="classCSMAMacLayer.html#x4">States</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p0">macState</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">kepp track of MAC state <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p1"></a><!-- doxytag: member="CSMAMacLayer::radioState" ref="p1" args="" -->
<a class="el" href="classRadioState.html#w6">RadioState::States</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p1">radioState</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current state of active channel (radio), set using radio, updated via BB. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p2"></a><!-- doxytag: member="CSMAMacLayer::catRadioState" ref="p2" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p2">catRadioState</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">category number given by bb for <a class="el" href="classRadioState.html">RadioState</a> <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p3"></a><!-- doxytag: member="CSMAMacLayer::rssi" ref="p3" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p3">rssi</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Last <a class="el" href="classRSSI.html">RSSI</a> level. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p4"></a><!-- doxytag: member="CSMAMacLayer::catRSSI" ref="p4" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p4">catRSSI</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">category number given by bb for <a class="el" href="classRSSI.html">RSSI</a> <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p5"></a><!-- doxytag: member="CSMAMacLayer::busyRSSI" ref="p5" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p5">busyRSSI</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classRSSI.html">RSSI</a> level where medium is considered busy. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p6">slotDuration</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Duration of a slot.  <a href="#p6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p7">difs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum time between a packet and its ACK.  <a href="#p7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p8"></a><!-- doxytag: member="CSMAMacLayer::radio" ref="p8" args="" -->
<a class="el" href="classSingleChannelRadio.html">SingleChannelRadio</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p8">radio</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cached pointer to radio module <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p9"></a><!-- doxytag: member="CSMAMacLayer::macQueue" ref="p9" args="" -->
MacQueue&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p9">macQueue</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A queue to store packets from upper layer in case another packet is still waiting for transmission.. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p10"></a><!-- doxytag: member="CSMAMacLayer::queueLength" ref="p10" args="" -->
unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p10">queueLength</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">length of the queue <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p11"></a><!-- doxytag: member="CSMAMacLayer::backoffTimer" ref="p11" args="" -->
cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p11">backoffTimer</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer for backoff (non-persistent CSMA). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p12">minorMsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Multi-purpose message.  <a href="#p12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p13">txAttempts</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">count the number of tx attempts  <a href="#p13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p14">maxTxAttempts</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">maximum number of transmission attempts  <a href="#p14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p15"></a><!-- doxytag: member="CSMAMacLayer::bitrate" ref="p15" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p15">bitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the bit rate at which we transmit <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p16"></a><!-- doxytag: member="CSMAMacLayer::initialCW" ref="p16" args="" -->
unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p16">initialCW</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">initial contention window size <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p17"></a><!-- doxytag: member="CSMAMacLayer::droppedPacket" ref="p17" args="" -->
<a class="el" href="classDroppedPacket.html">DroppedPacket</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p17">droppedPacket</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inspect reasons for dropped packets. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p18"></a><!-- doxytag: member="CSMAMacLayer::catDroppedPacket" ref="p18" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p18">catDroppedPacket</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">plus category from BB <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p19"></a><!-- doxytag: member="CSMAMacLayer::nicId" ref="p19" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCSMAMacLayer.html#p19">nicId</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">publish dropped packets nic wide <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
MAC module which provides non-persistent CSMA. 
<p>
This is an implementation of a simple non-persistent CSMA. The idea of nonpersistent CSMA is "listen before talk". Before attempting to transmit, a station will sense the medium for a carrier signal, which, if present, indicates that some other station is sending.<p>
If the channel is busy a random waiting time is computed and after this time the channel is sensed again. Once the channel gets idle the message is sent. (State of the channel is obtained from <a class="el" href="classSnrEval.html">SnrEval</a> via <a class="el" href="classBlackboard.html">Blackboard</a>.)<p>
An option of this module is to use a queue. If a packet from the upper layer arrives although there is still another packet waiting for its transmission or being transmitted the new packet can be stored in this queue. The length of this queue can be specified by the user in the omnetpp.ini file. By default the length is 0. If the queue is full or there is no queue (length = 0) new packet(s) will be deleted.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Inform upper layers about the full queue!</dd></dl>
ATTENTION: Imagine the following scenario:<p>
Several stations receive a broadcast request packet, usally exactly at the same time. They will all try to answer at exactly the same time, i.e. they all will sense the channel at exactly the same time and start to transmit because the channel was sensed idle by all of them. Therefore a small random delay should be built into one/some of the upper layers to simulate a random processing time!<p>
The <a class="el" href="classTestApplLayer.html">TestApplLayer</a> e.g. implements such a processing delay!<p>
<dl compact><dt><b>Author:</b></dt><dd>Marc Löbbers, Yosia Hadisusanto, Andreas Koepke</dd></dl>

<p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="x4"></a><!-- doxytag: member="CSMAMacLayer::States" ref="x4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="classCSMAMacLayer.html#x4">CSMAMacLayer::States</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
MAC states. 
<p>
The MAC states help to keep track what the MAC is actually trying to do -- this is esp. useful when radio switching takes some time. RX -- MAC accepts packets from PHY layer TX -- MAC transmits a packet CCA -- Clear Channel Assessment - MAC checks whether medium is busy    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a3"></a><!-- doxytag: member="CSMAMacLayer::handleLowerMsg" ref="a3" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void CSMAMacLayer::handleLowerMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from lower layer. 
<p>
Compare the address of this Host with the destination address in frame. If they are equal or the frame is broadcast, we send this frame to the upper layer. If not delete it.
<p>
Reimplemented from <a class="el" href="classBasicMacLayer.html#a3">BasicMacLayer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5"></a><!-- doxytag: member="CSMAMacLayer::handleSelfMsg" ref="a5" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void CSMAMacLayer::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle self messages such as timers. 
<p>
After the timer expires try to retransmit the message by calling handleUpperMsg again.
<p>
Implements <a class="el" href="classBasicLayer.html#z16_0">BasicLayer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4"></a><!-- doxytag: member="CSMAMacLayer::handleUpperMsg" ref="a4" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void CSMAMacLayer::handleUpperMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from upper layer. 
<p>
First it has to be checked whether a frame is currently being transmitted or waiting to be transmitted. If so the newly arrived message is stored in a queue. If there is no queue or it is full print a warning.<p>
Before transmitting a frame it is tested whether the channel is busy at the moment or not. If the channel is busy, a short random time will be generated and the MacPkt is buffered for this time, before a next attempt to send the packet is started.<p>
If channel is idle the frame will be transmitted immediately.
<p>
Implements <a class="el" href="classBasicMacLayer.html#a2">BasicMacLayer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7"></a><!-- doxytag: member="CSMAMacLayer::receiveBBItem" ref="a7" args="(int category, const BBItem *details, int scopeModuleId)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void CSMAMacLayer::receiveBBItem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classBBItem.html">BBItem</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>details</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>scopeModuleId</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called by the <a class="el" href="classBlackboard.html">Blackboard</a> whenever a change occurs we're interested in. 
<p>
Update the internal copies of interesting BB variables
<p>
Reimplemented from <a class="el" href="classBasicModule.html#a4">BasicModule</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b0"></a><!-- doxytag: member="CSMAMacLayer::scheduleBackoff" ref="b0" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void CSMAMacLayer::scheduleBackoff           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
schedule a backoff 
<p>
A non-persistent CSMA ideally uses a fixed backoff window, but it could also increase this window in a linear fashion, or even exponential -- here, a linear increase is used. Overwrite this function to define another schedule function. It also checks the retransmission counters -- if you overwrite it, do it with care.    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p7"></a><!-- doxytag: member="CSMAMacLayer::difs" ref="p7" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="classCSMAMacLayer.html#p7">CSMAMacLayer::difs</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Maximum time between a packet and its ACK. 
<p>
Usually this is slightly more then the tx-rx turnaround time The channel should stay clear within this period of time.    </td>
  </tr>
</table>
<a class="anchor" name="p14"></a><!-- doxytag: member="CSMAMacLayer::maxTxAttempts" ref="p14" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned <a class="el" href="classCSMAMacLayer.html#p14">CSMAMacLayer::maxTxAttempts</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
maximum number of transmission attempts 
<p>
The packet is discared when this number is reached.    </td>
  </tr>
</table>
<a class="anchor" name="p12"></a><!-- doxytag: member="CSMAMacLayer::minorMsg" ref="p12" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">cMessage* <a class="el" href="classCSMAMacLayer.html#p12">CSMAMacLayer::minorMsg</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Multi-purpose message. 
<p>
Keeps track of things like minimum time of clear channel (important for atomic acks) and race condition avoidance.    </td>
  </tr>
</table>
<a class="anchor" name="p6"></a><!-- doxytag: member="CSMAMacLayer::slotDuration" ref="p6" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double <a class="el" href="classCSMAMacLayer.html#p6">CSMAMacLayer::slotDuration</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Duration of a slot. 
<p>
This duration can be a mini-slot (that is an RX-TX-turnaround time) but in general it should be the time it takes to send a packet plus some guard times (RX-TX-turnaround + a minimum inter-packet space).    </td>
  </tr>
</table>
<a class="anchor" name="p13"></a><!-- doxytag: member="CSMAMacLayer::txAttempts" ref="p13" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned <a class="el" href="classCSMAMacLayer.html#p13">CSMAMacLayer::txAttempts</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
count the number of tx attempts 
<p>
This holds the number of transmission attempts, since no Acks are used this is the way how we can empty our queue even with overloaded channels.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="CSMAMacLayer_8h-source.html">CSMAMacLayer.h</a><li>CSMAMacLayer.cc</ul>
<hr size="1"><address style="align: right;"><small>Generated on Fri Jan 12 08:29:55 2007 for Mobility Framework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
